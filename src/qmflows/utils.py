"""Miscellaneous utilities."""

__author__ = "Felipe Zapata"

__all__ = ['dict2Setting', 'settings2Dict', 'zipWith', 'zipWith3']


from pymonad import curry
from .settings import Settings


@curry
def zipWith(f, xs, ys):
    """zipWith generalises zip by zipping with the function given as the first argument"""
    return [f(*rs) for rs in zip(xs, ys)]


@curry
def zipWith3(f, xs, ys, zs):
    """The zipWith3 function takes a function which combines three elements,
    as well as three lists and returns a list of their point-wise combination.
    """
    return [f(*rs) for rs in zip(xs, ys, zs)]


def settings2Dict(s):
    """Transform a Settings object into a dict."""
    d = {}
    for k, v in s.items():
        if not isinstance(v, Settings):
            d[k] = v
        else:
            d[k] = settings2Dict(v)

    return d


def dict2Setting(d):
    """Transform recursively a dict into a Settings object."""
    r = Settings()
    for k, v in d.items():
        if isinstance(v, dict):
            r[k] = dict2Setting(v)
        else:
            r[k] = v

    return r
